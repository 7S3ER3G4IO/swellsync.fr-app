<!DOCTYPE html>
<html class="dark" lang="fr">

<head>
    <script src="js/app-guard.js"></script>
    <meta charset="utf-8" />
    <meta content="width=device-width,initial-scale=1.0" name="viewport" />
    <title>SwellSync - Accueil</title>
    <meta property="og:type" content="website">
    <meta property="og:title" content="SwellSync ‚Äî Accueil">
    <meta property="og:description" content="Pr√©visions surf en temps r√©el pour 60+ spots de la c√¥te Atlantique.">
    <meta property="og:image" content="https://swellsync.fr/assets/images/swellsync_logo.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/assets/images/swellsync_logo.png">
    <script src="js/theme.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script>tailwind.config = { darkMode: "class", theme: { extend: { colors: { "primary": "#00bad6", "background-dark": "#080f1a", "card-dark": "#0f2438" }, fontFamily: { "display": ["Space Grotesk", "sans-serif"] } } } }</script>
    <style>
        .dark body {
            background: #080f1a;
            color: #f1f5f9
        }

        .dark .card {
            background: rgba(15, 36, 56, 0.8);
            border: 1px solid rgba(0, 186, 214, 0.12)
        }

        .dark .hdr {
            background: rgba(8, 15, 26, 0.85);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(0, 186, 214, 0.1)
        }

        .light body {
            background: #f0f6ff;
            color: #1e293b
        }

        .light .card {
            background: #fff;
            border: 1px solid #e2eaf4;
            box-shadow: 0 2px 12px rgba(0, 0, 0, .06)
        }

        .light .hdr {
            background: rgba(240, 246, 255, 0.9);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid #e2eaf4
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            min-height: 100dvh
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none
        }

        .skeleton {
            background: linear-gradient(90deg, rgba(0, 186, 214, .06) 25%, rgba(0, 186, 214, .12) 50%, rgba(0, 186, 214, .06) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.4s infinite
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 0
            }

            100% {
                background-position: -200% 0
            }
        }

        @keyframes pulse-live {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: .4
            }
        }

        .live-dot {
            animation: pulse-live 1.5s ease-in-out infinite
        }

        /* Story ring */
        .story-ring {
            background: conic-gradient(#00bad6, #0077b6, #00bad6);
            padding: 2px;
            border-radius: 50%;
        }

        .story-ring-add {
            background: linear-gradient(135deg, #00bad6, #0077b6);
        }

        /* Hero spot card */
        .hero-spot {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            min-height: 260px;
        }

        .hero-spot img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
        }

        .hero-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(8, 15, 26, 0.2) 0%, rgba(8, 15, 26, 0.85) 70%);
        }

        .hero-content {
            position: relative;
            z-index: 2;
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        /* Quick action buttons */
        .quick-btn {
            background: rgba(15, 36, 56, 0.8);
            border: 1px solid rgba(0, 186, 214, 0.15);
            border-radius: 16px;
            padding: 16px 12px;
            text-align: center;
            flex: 1;
            transition: all .15s;
        }

        .quick-btn:active {
            transform: scale(0.95)
        }

        .quick-btn .icon {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            background: rgba(0, 186, 214, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
        }

        .quick-btn .icon .material-symbols-outlined {
            color: #00bad6;
            font-size: 24px
        }

        .quick-btn span:last-child {
            font-size: 11px;
            font-weight: 700;
            color: #94a3b8
        }

        /* Spot carousel card */
        .spot-slide {
            min-width: 170px;
            border-radius: 16px;
            overflow: hidden;
            flex-shrink: 0;
            position: relative;
        }

        .spot-slide img {
            width: 100%;
            height: 180px;
            object-fit: cover
        }

        .spot-slide .label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, .8));
            padding: 40px 12px 12px;
        }

        /* Community floating button */
        .fab {
            position: fixed;
            bottom: 90px;
            right: 16px;
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00bad6, #0077b6);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 24px rgba(0, 186, 214, .35);
            z-index: 40;
            transition: transform .15s;
        }

        .fab:active {
            transform: scale(0.9)
        }
    </style>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#00bad6">
</head>

<body class="font-display pb-24">

    <!-- Header -->
    <header class="hdr sticky top-0 z-30 px-4 py-3">
        <div class="flex items-center gap-3">
            <img src="/assets/images/swellsync_logo.png" alt="SwellSync"
                class="w-8 h-8 rounded-full border border-[#00bad6]/30">
            <h1 class="text-lg font-bold flex-1">Swell<span class="text-[#00bad6]">Sync</span></h1>
            <a href="search.html" class="w-9 h-9 rounded-full bg-white/5 flex items-center justify-center">
                <span class="material-symbols-outlined text-[20px] text-slate-400">search</span>
            </a>
            <a href="notifications.html"
                class="w-9 h-9 rounded-full bg-white/5 flex items-center justify-center relative">
                <span class="material-symbols-outlined text-[20px] text-slate-400">notifications</span>
                <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
            </a>
            <a href="profile.html"
                class="w-9 h-9 rounded-full bg-[#00bad6]/20 flex items-center justify-center border border-[#00bad6]/40">
                <span class="material-symbols-outlined text-[20px] text-[#00bad6]">person</span>
            </a>
        </div>
    </header>

    <main class="px-4 py-3 space-y-5 max-w-lg mx-auto">

        <!-- Stories Row -->
        <div class="flex gap-3 overflow-x-auto no-scrollbar py-1">
            <!-- Add Story -->
            <div class="flex flex-col items-center gap-1.5 flex-shrink-0">
                <div class="w-16 h-16 rounded-full story-ring-add flex items-center justify-center">
                    <span class="material-symbols-outlined text-white text-2xl">add</span>
                </div>
                <span class="text-[10px] text-slate-500">Ta story</span>
            </div>
            <!-- Story placeholders -->
            <div class="flex flex-col items-center gap-1.5 flex-shrink-0" id="storySlots"></div>
        </div>

        <!-- Hero: Nearest Spot -->
        <a href="spot_detail.html?id=1" class="hero-spot block active:scale-[.98] transition-transform" id="heroSpot">
            <img src="https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=600&q=80" alt="Spot">
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <!-- Top label -->
                <div class="flex items-center gap-2 mb-auto">
                    <span class="text-[10px] font-bold text-red-400 uppercase tracking-wider">üìç Spot le plus
                        proche</span>
                    <span class="flex items-center gap-1 text-[10px] text-emerald-400 font-bold">
                        <span class="w-1.5 h-1.5 bg-emerald-400 rounded-full live-dot"></span> Live
                    </span>
                </div>

                <!-- Spot info -->
                <div class="mt-auto">
                    <h2 class="text-2xl font-black text-white" id="heroName">La Gravi√®re</h2>
                    <p class="text-sm text-white/60" id="heroLocation">Hossegor, Landes</p>

                    <!-- Wave height bar -->
                    <div class="mt-3 flex items-center gap-3">
                        <div class="h-2 bg-white/20 rounded-full flex-1 overflow-hidden">
                            <div class="h-full bg-white rounded-full transition-all" id="waveBar" style="width:40%">
                            </div>
                        </div>
                        <span class="text-lg font-black text-white" id="heroHeight">‚Äî m</span>
                    </div>

                    <!-- Conditions grid -->
                    <div class="grid grid-cols-2 gap-x-6 gap-y-1.5 mt-3">
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-[16px] text-[#00bad6]">waves</span>
                            <span class="text-xs text-white/70">Houle: <strong class="text-white"
                                    id="heroSwell">‚Äî</strong></span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-[16px] text-[#00bad6]">air</span>
                            <span class="text-xs text-white/70">Vent: <strong class="text-white"
                                    id="heroWind">‚Äî</strong></span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-[16px] text-[#00bad6]">water_drop</span>
                            <span class="text-xs text-white/70">Mar√©e: <strong class="text-[#00bad6]"
                                    id="heroTide">Montante</strong></span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-[16px] text-[#00bad6]">thermostat</span>
                            <span class="text-xs text-white/70">Eau: <strong class="text-white"
                                    id="heroTemp">‚Äî</strong></span>
                        </div>
                    </div>
                </div>
            </div>
        </a>

        <!-- Quick Actions -->
        <div class="flex gap-3">
            <a href="map.html" class="quick-btn">
                <div class="icon"><span class="material-symbols-outlined">map</span></div>
                <span>Spot Map</span>
            </a>
            <a href="alerts.html" class="quick-btn">
                <div class="icon"><span class="material-symbols-outlined">calendar_month</span></div>
                <span>7-Day</span>
            </a>
            <a href="alerts.html" class="quick-btn">
                <div class="icon"><span class="material-symbols-outlined">notifications_active</span></div>
                <span>Alertes</span>
            </a>
        </div>

        <!-- Top Spots Today -->
        <div>
            <div class="flex items-center justify-between mb-3">
                <h3 class="font-black text-base">Top spots aujourd'hui</h3>
                <a href="map.html" class="text-xs text-[#00bad6] font-bold">Voir tous</a>
            </div>
            <div class="flex gap-3 overflow-x-auto no-scrollbar pb-2" id="topSpots">
                <div class="spot-slide skeleton" style="min-width:170px;height:220px"></div>
                <div class="spot-slide skeleton" style="min-width:170px;height:220px"></div>
                <div class="spot-slide skeleton" style="min-width:170px;height:220px"></div>
            </div>
        </div>

        <!-- Recent Activity / Sessions -->
        <div>
            <div class="flex items-center justify-between mb-3">
                <h3 class="font-black text-base">üî• Sessions r√©centes</h3>
                <a href="community.html" class="text-xs text-[#00bad6] font-bold">Voir tout ‚Üí</a>
            </div>
            <div class="space-y-2" id="recentSessions">
                <div class="card rounded-2xl p-3 flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-[#00bad6]/20 flex items-center justify-center flex-shrink-0">
                        <span class="material-symbols-outlined text-[#00bad6] text-lg">surfing</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-bold text-sm truncate">Session du jour</p>
                        <p class="text-[10px] text-slate-500">Rejoins la communaut√© pour voir les sessions</p>
                    </div>
                    <span class="material-symbols-outlined text-slate-600">chevron_right</span>
                </div>
            </div>
        </div>

        <!-- Pro Banner -->
        <a href="abonnement.html"
            class="block card rounded-3xl p-5 border-amber-400/30 active:scale-[.98] transition-transform"
            style="background:linear-gradient(135deg,rgba(245,158,11,.1),rgba(217,119,6,.05))">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 rounded-2xl bg-amber-400/20 flex items-center justify-center flex-shrink-0">
                    <span class="material-symbols-outlined text-amber-400 text-2xl"
                        style="font-variation-settings:'FILL' 1">star</span>
                </div>
                <div class="flex-1">
                    <p class="font-black text-sm text-amber-300">SwellSync Pro</p>
                    <p class="text-[11px] text-slate-400 mt-0.5">Cam√©ras HD ¬∑ Pr√©visions 15j ¬∑ Favoris illimit√©s</p>
                </div>
                <span class="material-symbols-outlined text-amber-400">chevron_right</span>
            </div>
        </a>

    </main>

    <!-- Community FAB -->
    <a href="community.html" class="fab">
        <span class="material-symbols-outlined text-white text-xl"
            style="font-variation-settings:'FILL' 1">groups</span>
    </a>

    <!-- Bottom Nav -->
    <nav class="fixed bottom-0 left-0 right-0 border-t border-[#00bad6]/20 pb-6 pt-2 px-2 flex justify-between items-center z-50 backdrop-blur-lg"
        style="background: var(--nav-bg, rgba(8,15,26,0.95))">
        <a class="flex flex-col items-center gap-1 text-[#00bad6] flex-1" href="home.html">
            <span class="material-symbols-outlined" style="font-variation-settings:'FILL' 1">home</span>
            <span class="text-[10px] font-bold">Home</span>
            <div class="w-1 h-1 bg-[#00bad6] rounded-full mt-0.5"></div>
        </a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="map.html">
            <span class="material-symbols-outlined">travel_explore</span>
            <span class="text-[10px]">Spots</span>
        </a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="alerts.html">
            <span style="position:relative;display:inline-block;">
                <span class="material-symbols-outlined">notifications</span>
                <span
                    style="position:absolute;top:-1px;left:-3px;font-size:8px;line-height:1;z-index:2;display:inline-flex;align-items:center;justify-content:center;background:#f59e0b;border-radius:50%;width:11px;height:11px;font-weight:900;color:#080f1a;">‚≠ê</span>
            </span>
            <span class="text-[10px]">Alertes</span>
        </a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="community.html">
            <span class="material-symbols-outlined">groups</span>
            <span class="text-[10px]">Communaut√©</span>
        </a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="profile.html">
            <span class="material-symbols-outlined">person</span>
            <span class="text-[10px]">Profil</span>
        </a>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="js/api.js"></script>
    <script>
        const SPOT_IMAGES = [
            'https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=600&q=80',
            'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=600&q=80',
            'https://images.unsplash.com/photo-1505459668311-8dfac7952bf0?w=600&q=80',
            'https://images.unsplash.com/photo-1455729552457-5c322b29c789?w=600&q=80',
            'https://images.unsplash.com/photo-1519451241324-20b4ea2c4220?w=600&q=80',
            'https://images.unsplash.com/photo-1484291470158-b8f8d608850d?w=600&q=80',
            'https://images.unsplash.com/photo-1509914398892-963f53e6e2f1?w=600&q=80',
            'https://images.unsplash.com/photo-1416163785019-75f3889c56b0?w=600&q=80',
            'https://images.unsplash.com/photo-1476673160081-cf065607f449?w=600&q=80',
            'https://images.unsplash.com/photo-1505142468610-359e7d316be0?w=600&q=80',
            'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=600&q=80',
            'https://images.unsplash.com/photo-1437719417032-8b217f069f31?w=600&q=80'
        ];
        function getSpotImg(spot) {
            if (!spot) return SPOT_IMAGES[0];
            const hash = ((spot.id || 0) * 2654435761) >>> 0;
            return SPOT_IMAGES[hash % SPOT_IMAGES.length];
        }

        const DIFF_LABELS = { debutant: 'üåä D√©butant', intermediaire: '‚ö° Interm√©diaire', avance: 'üî• Avanc√©', expert: 'üíÄ Expert' };
        const DIFF_COLORS = { debutant: 'bg-emerald-500/80', intermediaire: 'bg-yellow-500/80', avance: 'bg-orange-500/80', expert: 'bg-red-500/80' };

        async function init() {
            try {
                const spots = await API.spots.list();

                // Hero spot (first/nearest)
                if (spots.length) {
                    const hero = spots[0];
                    document.getElementById('heroName').textContent = hero.name;
                    document.getElementById('heroLocation').textContent = hero.location;
                    document.getElementById('heroSpot').href = 'spot_detail.html?id=' + hero.id;

                    // Simulated live conditions
                    const h = (1.0 + Math.abs(Math.sin(hero.id * 7)) * 2.5).toFixed(1);
                    document.getElementById('heroHeight').textContent = h + ' m';
                    document.getElementById('heroSwell').textContent = h + 'm ' + ['NW', 'W', 'SW', 'N'][hero.id % 4];
                    document.getElementById('heroWind').textContent = (5 + (hero.id * 3) % 20) + ' km/h';
                    document.getElementById('heroTemp').textContent = (14 + hero.id % 6) + '¬∞C';
                    const tides = ['Montante', 'Descendante', 'Haute', 'Basse', '√âtale'];
                    document.getElementById('heroTide').textContent = tides[hero.id % tides.length];
                    document.getElementById('waveBar').style.width = Math.min(95, (h / 3) * 100) + '%';

                    // Hero image
                    const heroImg = document.querySelector('.hero-spot img');
                    heroImg.src = getSpotImg(hero);
                }

                // Top spots carousel
                const top = spots.slice(0, 8);
                let carouselHtml = '';
                top.forEach((s, i) => {
                    const diff = (s.difficulty || 'intermediaire').toLowerCase();
                    const label = DIFF_LABELS[diff] || diff;
                    const color = DIFF_COLORS[diff] || 'bg-slate-600/80';
                    carouselHtml += `
                    <a href="spot_detail.html?id=${s.id}" class="spot-slide card active:scale-[.97] transition-transform">
                        <img src="${getSpotImg(s)}" alt="${s.name}" loading="lazy">
                        <div class="label">
                            <span class="inline-block text-[10px] font-bold text-white px-2 py-0.5 rounded-full ${color} mb-1.5">${label}</span>
                            <p class="text-white font-bold text-sm truncate">${s.name}</p>
                            <p class="text-white/50 text-[10px] truncate">${s.location}</p>
                        </div>
                    </a>`;
                });
                document.getElementById('topSpots').innerHTML = carouselHtml;

            } catch (e) {
                console.error('Init error:', e);
                document.getElementById('topSpots').innerHTML = '<p class="text-slate-500 text-xs py-4">Connexion au serveur‚Ä¶</p>';
            }
        }

        init();
    </script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(() => { });
        }
    </script>
    <script src="js/ui-components.js"></script>
    <script src="js/notif-badge.js"></script>
    <script src="/js/i18n.js"></script>
</body>

</html>