<!DOCTYPE html>
<html class="dark" lang="fr">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width,initial-scale=1.0,viewport-fit=cover" name="viewport" />
    <title>SwellSync - Session Live</title>
    <script src="js/theme.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="css/transitions.css">
    <script>tailwind.config = { darkMode: "class", theme: { extend: { colors: { "primary": "#00bad6" }, fontFamily: { "display": ["Space Grotesk", "sans-serif"] } } } }</script>
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: 'Space Grotesk', sans-serif;
            min-height: 100dvh
        }

        .card {
            background: #111;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 16px
        }

        .timer {
            font-size: 64px;
            font-weight: 800;
            letter-spacing: -2px;
            font-variant-numeric: tabular-nums
        }

        .pulse-ring {
            animation: pulseRing 2s ease infinite
        }

        @keyframes pulseRing {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 186, 214, 0.4)
            }

            70% {
                box-shadow: 0 0 0 15px rgba(0, 186, 214, 0)
            }

            100% {
                box-shadow: 0 0 0 0 rgba(0, 186, 214, 0)
            }
        }

        .stat-card {
            background: #111;
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 14px;
            padding: 14px;
            text-align: center
        }

        .wave-count {
            animation: waveIn 0.3s ease
        }

        @keyframes waveIn {
            from {
                transform: scale(1.3);
                opacity: 0
            }

            to {
                transform: scale(1);
                opacity: 1
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="sticky top-0 z-30 px-4 py-3 backdrop-blur-xl"
        style="background:rgba(0,0,0,0.92);border-bottom:1px solid rgba(255,255,255,0.06)">
        <div class="flex items-center gap-3">
            <a href="home.html" class="tap"><span class="material-symbols-outlined text-white">close</span></a>
            <h1 class="text-lg font-bold flex-1">Session <span class="text-[#00bad6]">Live</span></h1>
            <div class="flex items-center gap-1.5">
                <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                <span class="text-xs text-red-400 font-bold" id="liveLabel">EN DIRECT</span>
            </div>
        </div>
    </header>

    <main class="px-4 py-4 space-y-4 max-w-lg mx-auto page-enter">

        <!-- Timer -->
        <div class="flex flex-col items-center py-6">
            <div class="w-40 h-40 rounded-full border-4 border-[#00bad6] flex items-center justify-center pulse-ring"
                id="timerRing">
                <div class="text-center">
                    <p class="timer" id="timer">00:00</p>
                    <p class="text-xs text-white/50 mt-1">Dur√©e de session</p>
                </div>
            </div>
        </div>

        <!-- Spot info -->
        <div class="card flex items-center gap-3">
            <span class="material-symbols-outlined text-[#00bad6]">location_on</span>
            <div class="flex-1">
                <p class="text-sm font-bold" id="spotName">D√©tection du spot...</p>
                <p class="text-[10px] text-white/40" id="coords">GPS en cours</p>
            </div>
            <div class="text-right">
                <p class="text-xs text-white/50">Conditions</p>
                <p class="text-sm font-bold text-[#00bad6]">‚≠ê‚≠ê‚≠ê‚≠ê</p>
            </div>
        </div>

        <!-- Live Stats -->
        <div class="grid grid-cols-3 gap-2">
            <div class="stat-card">
                <p class="text-2xl font-bold text-[#00bad6]" id="waveCount">0</p>
                <p class="text-[10px] text-white/50 mt-1">üåä Vagues</p>
            </div>
            <div class="stat-card">
                <p class="text-2xl font-bold" id="maxSpeed">0</p>
                <p class="text-[10px] text-white/50 mt-1">‚ö° km/h max</p>
            </div>
            <div class="stat-card">
                <p class="text-2xl font-bold" id="distance">0</p>
                <p class="text-[10px] text-white/50 mt-1">üìè m√®tres</p>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-2">
            <div class="stat-card">
                <p class="text-lg font-bold">15¬∞C</p>
                <p class="text-[10px] text-white/50 mt-1">üå°Ô∏è Eau</p>
            </div>
            <div class="stat-card">
                <p class="text-lg font-bold">2.1m</p>
                <p class="text-[10px] text-white/50 mt-1">üåä Houle</p>
            </div>
        </div>

        <!-- Wave log -->
        <div class="card">
            <div class="flex items-center justify-between mb-3">
                <h2 class="font-bold text-sm">Journal de vagues</h2>
                <button onclick="logWave()"
                    class="bg-[#00bad6] text-black font-bold text-xs px-4 py-2 rounded-xl tap flex items-center gap-1">
                    <span class="material-symbols-outlined text-sm">add</span>Vague !
                </button>
            </div>
            <div class="space-y-1.5 max-h-[200px] overflow-y-auto" id="waveLog">
                <p class="text-xs text-white/30 text-center py-4">Appuie sur "Vague !" pour chaque vague surf√©e üèÑ</p>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex gap-3">
            <button onclick="toggleSession()" id="startBtn"
                class="flex-1 bg-[#00bad6] text-black font-black py-4 rounded-2xl text-sm tap flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">play_arrow</span>D√©marrer la session
            </button>
            <button onclick="endSession()" id="endBtn"
                class="hidden flex-1 bg-red-500/20 text-red-400 border border-red-500/30 font-black py-4 rounded-2xl text-sm tap flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">stop</span>Terminer
            </button>
        </div>

    </main>

    <!-- Bottom Nav -->
    <nav class="fixed bottom-0 left-0 right-0 border-t border-white/10 pb-6 pt-2 px-2 flex justify-between items-center z-50 backdrop-blur-lg"
        style="background:rgba(0,0,0,0.95)">
        <a class="flex flex-col items-center gap-1 text-white flex-1" href="home.html"><span
                class="material-symbols-outlined">home</span><span class="text-[10px]">Home</span></a>
        <a class="flex flex-col items-center gap-1 text-white flex-1" href="map.html"><span
                class="material-symbols-outlined">travel_explore</span><span class="text-[10px]">Spots</span></a>
        <a class="flex flex-col items-center gap-1 text-white flex-1" href="alerts.html"><span
                class="material-symbols-outlined">notifications</span><span class="text-[10px]">Alertes</span></a>
        <a class="flex flex-col items-center gap-1 text-white flex-1" href="community.html"><span
                class="material-symbols-outlined">groups</span><span class="text-[10px]">Communaut√©</span></a>
        <a class="flex flex-col items-center gap-1 text-white flex-1" href="profile.html"><span
                class="material-symbols-outlined">person</span><span class="text-[10px]">Profil</span></a>
    </nav>

    <script>
        let running = false, seconds = 0, interval = null, waves = 0;

        function toggleSession() {
            if (!running) {
                running = true;
                document.getElementById('startBtn').innerHTML = '<span class="material-symbols-outlined">pause</span>Pause';
                document.getElementById('endBtn').classList.remove('hidden');
                document.getElementById('liveLabel').textContent = 'EN DIRECT';
                interval = setInterval(() => {
                    seconds++;
                    const m = String(Math.floor(seconds / 60)).padStart(2, '0');
                    const s = String(seconds % 60).padStart(2, '0');
                    document.getElementById('timer').textContent = m + ':' + s;
                    // Simulate distance
                    document.getElementById('distance').textContent = Math.floor(seconds * 1.2);
                    // Simulate max speed
                    if (seconds % 15 === 0) {
                        const spd = Math.floor(12 + Math.random() * 10);
                        const cur = parseInt(document.getElementById('maxSpeed').textContent);
                        if (spd > cur) document.getElementById('maxSpeed').textContent = spd;
                    }
                }, 1000);
                // Simulate GPS
                setTimeout(() => {
                    document.getElementById('spotName').textContent = 'La Gravi√®re, Hossegor';
                    document.getElementById('coords').textContent = '43.6615¬∞ N, 1.4445¬∞ W';
                }, 1500);
            } else {
                running = false;
                clearInterval(interval);
                document.getElementById('startBtn').innerHTML = '<span class="material-symbols-outlined">play_arrow</span>Reprendre';
                document.getElementById('liveLabel').textContent = 'PAUSE';
            }
        }

        function logWave() {
            if (!running) return;
            waves++;
            const el = document.getElementById('waveCount');
            el.textContent = waves;
            el.classList.remove('wave-count');
            void el.offsetWidth;
            el.classList.add('wave-count');

            const log = document.getElementById('waveLog');
            if (waves === 1) log.innerHTML = '';
            const m = String(Math.floor(seconds / 60)).padStart(2, '0');
            const s = String(seconds % 60).padStart(2, '0');
            const rating = ['üî• Tube!', 'üí™ Bonne', 'ü§ô Nice', '‚ú® Clean'][Math.floor(Math.random() * 4)];
            const entry = document.createElement('div');
            entry.className = 'flex items-center justify-between py-1.5 border-b border-white/5 fade-in';
            entry.innerHTML = `
            <div class="flex items-center gap-2">
                <span class="text-xs font-bold text-[#00bad6]">#${waves}</span>
                <span class="text-xs text-white/60">${m}:${s}</span>
            </div>
            <span class="text-xs font-bold">${rating}</span>`;
            log.prepend(entry);

            // Easter egg: 10 waves combo!
            if (waves === 10) {
                showCombo('üî• 10 VAGUES COMBO !');
            } else if (waves === 25) {
                showCombo('‚ö° 25 VAGUES ‚Äî MACHINE !');
            } else if (waves === 50) {
                showCombo('üèÜ 50 VAGUES ‚Äî L√âGENDE !');
            }
        }

        function showCombo(text) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = text;
            document.body.appendChild(toast);
            setTimeout(() => { toast.classList.add('out'); setTimeout(() => toast.remove(), 300); }, 2500);
        }

        function endSession() {
            running = false;
            clearInterval(interval);
            const m = Math.floor(seconds / 60);
            const dist = document.getElementById('distance').textContent;
            const spd = document.getElementById('maxSpeed').textContent;
            // Save session
            const sessions = JSON.parse(localStorage.getItem('sw_sessions') || '[]');
            sessions.push({
                date: new Date().toISOString(),
                spot: document.getElementById('spotName').textContent,
                duration: m,
                waves: waves,
                distance: dist,
                maxSpeed: spd
            });
            localStorage.setItem('sw_sessions', JSON.stringify(sessions));
            showCombo(`‚úÖ Session sauvegard√©e ! ${waves} vagues en ${m}min`);
            setTimeout(() => { window.location.href = 'home.html'; }, 2000);
        }
    </script>
</body>

</html>