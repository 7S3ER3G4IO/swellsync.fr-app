<!DOCTYPE html>
<html lang="fr">

<head>
    <script src="js/app-guard.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>CommunautÃ© surf â€” SwellSync</title>
    <meta property="og:type" content="website">
    <meta property="og:title" content="SwellSync â€” CommunautÃ© Surf">
    <meta property="og:description" content="CommunautÃ© de surfeurs : partage tes sessions.">
    <meta property="og:image" content="https://swellsync.fr/assets/images/swellsync_logo.png?v=3">
    <meta property="og:site_name" content="SwellSync">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://bxudysseskfpmlpagoid.supabase.co">
    <link rel="apple-touch-icon" href="/assets/images/swellsync_logo.png?v=3">
    <meta name="description"
        content="SwellSync CommunautÃ© â€” Partagez vos sessions, Ã©changez avec les surfeurs et suivez les conditions.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class', theme: { extend: { fontFamily: { display: ['Inter', 'system-ui', 'sans-serif'] } } } }</script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="js/api.js"></script>
    <style>
        * {
            font-family: 'Inter', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #000;
            color: #f1f5f9;
            overscroll-behavior: none;
        }

        .glass {
            background: rgba(15, 36, 56, .85);
            border: 1px solid rgba(0, 186, 214, .12);
        }

        .card {
            background: #111;
            border: 1px solid rgba(0, 186, 214, .12);
        }

        .chip {
            border: 1px solid rgba(0, 186, 214, .2);
            border-radius: 20px;
            padding: 5px 14px;
            font-size: 11px;
            font-weight: 700;
            color: #94a3b8;
            cursor: pointer;
            transition: all .2s;
            white-space: nowrap;
        }

        .chip.active {
            background: #00bad6;
            color: #000;
            border-color: #00bad6;
        }

        .badge-pro {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .badge-pays-basque {
            background: linear-gradient(135deg, #16a34a, #15803d);
            color: white;
        }

        .badge-landes {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
        }

        .badge-bretagne {
            background: linear-gradient(135deg, #111827, #374151);
            color: white;
            border: 1px solid #6b7280;
        }

        .badge-cote-azur {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
        }

        .badge-champion {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            color: white;
        }

        .badge-wsl {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }

        .post-enter {
            animation: fadeUp .3s ease both;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(10px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        @keyframes postHighlight {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 186, 214, 0);
                background: #111;
            }

            15% {
                box-shadow: 0 0 0 4px rgba(0, 186, 214, .55);
                background: rgba(0, 186, 214, .08);
            }

            70% {
                box-shadow: 0 0 0 3px rgba(0, 186, 214, .25);
                background: rgba(0, 186, 214, .04);
            }

            100% {
                box-shadow: none;
                background: #111;
            }
        }

        .post-highlight {
            animation: postHighlight 2.5s ease both;
        }

        .tab-bar {
            display: flex;
            gap: 2px;
            padding: 3px;
            background: rgba(0, 186, 214, .08);
            border-radius: 14px;
            border: 1px solid rgba(0, 186, 214, .15);
        }

        .tab-btn {
            flex: 1;
            padding: 7px 8px;
            border-radius: 11px;
            font-size: 11px;
            font-weight: 700;
            color: #64748b;
            transition: all .2s;
            text-align: center;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
        }

        .tab-btn.active {
            background: #00bad6;
            color: #000;
        }

        .reply-box {
            background: rgba(0, 186, 214, .06);
            border-left: 2px solid #00bad6;
            padding: 8px 10px;
            border-radius: 0 10px 10px 0;
            margin-top: 6px;
        }

        .like-btn.liked {
            color: #f43f5e !important;
        }

        .like-btn.liked .mat-icon {
            font-variation-settings: 'FILL' 1;
        }

        ::-webkit-scrollbar {
            width: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 186, 214, .25);
            border-radius: 2px;
        }

        .no-scroll::-webkit-scrollbar {
            display: none;
        }

        .ranking-1 {
            background: linear-gradient(135deg, rgba(251, 191, 36, .15), rgba(245, 158, 11, .08));
        }

        .ranking-2 {
            background: linear-gradient(135deg, rgba(148, 163, 184, .1), rgba(100, 116, 139, .05));
        }

        .ranking-3 {
            background: linear-gradient(135deg, rgba(251, 146, 60, .1), rgba(249, 115, 22, .05));
        }
    </style>
    <script src="js/theme.js"></script>

    <style>
        :root {
            --bg-primary: #000;
            --bg-card: #111;
            --bg-nav: rgba(8, 15, 26, 0.95);
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: rgba(0, 186, 214, 0.2);
        }

        .light {
            --bg-primary: #f0f4f8;
            --bg-card: #ffffff;
            --bg-nav: rgba(255, 255, 255, 0.95);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-color: rgba(0, 186, 214, 0.15);
        }

        .light body {
            background: var(--bg-primary) !important;
            color: var(--text-primary) !important;
        }

        .light .card,
        .light [class*="bg-[#111]"] {
            background: var(--bg-card) !important;
        }

        .light [class*="bg-[#000]"] {
            background: var(--bg-primary) !important;
        }

        .light [class*="bg-[#111]"] {
            background: #f8fafc !important;
        }

        .light [class*="text-white"] {
            color: #0f172a !important;
        }

        .light [class*="text-slate-400"],
        .light [class*="text-slate-500"] {
            color: #64748b !important;
        }

        .light [class*="border-[#00bad6]"] {
            border-color: rgba(0, 186, 214, 0.25) !important;
        }

        .light nav[style*="--nav-bg"] {
            --nav-bg: rgba(255, 255, 255, 0.95) !important;
            border-color: rgba(0, 186, 214, 0.15) !important;
        }

        .light .section-label {
            color: #334155 !important;
        }

        .light .setting-row:hover {
            background: #e2e8f0 !important;
        }
    </style>

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#00bad6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/assets/images/swellsync_logo.png?v=3">
    <!-- Splash screens iOS -->
    <link rel="apple-touch-startup-image" media="screen and (device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3)" href="/assets/splash/splash-1290x2796.png">
    <link rel="apple-touch-startup-image" media="screen and (device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3)" href="/assets/splash/splash-1179x2556.png">
    <link rel="apple-touch-startup-image" media="screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)" href="/assets/splash/splash-1170x2532.png">
    <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" href="/assets/splash/splash-1125x2436.png">
    <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="/assets/splash/splash-750x1334.png">
    <link rel="apple-touch-startup-image" media="screen and (device-width: 360px) and (device-height: 780px) and (-webkit-device-pixel-ratio: 3)" href="/assets/splash/splash-1080x2340.png">
  <link rel="canonical" href="https://swellsync.fr/pages/community.html">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4490968258367543" crossorigin="anonymous"></script>
</head>

<body class="min-h-screen pb-28">
  <a href="#main-content" class="skip-link" style="position:absolute;top:-40px;left:0;background:#0ea5e9;color:#fff;padding:8px 16px;z-index:9999;border-radius:0 0 8px 0;font-weight:600;text-decoration:none;transition:top .2s" onfocus="this.style.top='0'" onblur="this.style.top='-40px'">Aller au contenu principal</a>

    <!-- Header sticky -->
    <header
        class="sticky top-0 z-50 backdrop-blur-xl bg-[#000]/92 border-b border-[#00bad6]/15 px-4 py-2.5 flex items-center gap-3">
        <div class="flex items-center gap-2 flex-1 min-w-0">
            <div
                class="w-7 h-7 rounded-full bg-[#00bad6]/20 flex items-center justify-center border border-[#00bad6]/30 shrink-0 active:scale-95 transition-transform">
                <span class="material-symbols-outlined text-[#00bad6] text-sm">groups</span>
            </div>
            <span class="font-black text-base">CommunautÃ©</span>
            <span
                class="text-[9px] bg-emerald-500/20 text-emerald-400 px-2 py-0.5 rounded-full font-bold flex items-center gap-1 shrink-0">
                <span class="w-1 h-1 rounded-full bg-emerald-400 animate-pulse inline-block"></span> 247 en ligne
            </span>
        </div>
        <button type="button"
            class="w-8 h-8 rounded-full bg-[#00bad6]/10 flex items-center justify-center active:scale-95 transition-transform"
            onclick="showBadgeShop()">
            <span class="material-symbols-outlined text-[#00bad6] text-[18px]">military_tech</span>
        </button>
        <button type="button"
            class="w-8 h-8 rounded-full bg-[#00bad6]/10 flex items-center justify-center active:scale-95 transition-transform"
            onclick="showSearch()">
            <span class="material-symbols-outlined text-slate-400 text-[18px]">search</span>
        </button>
    </header>

    <!-- Tabs principaux -->
    <div class="px-3 py-3 sticky top-[49px] z-40 bg-[#000]/90 backdrop-blur-lg border-b border-white/5">
        <div class="tab-bar" id="mainTabs">
            <div class="tab-btn active" onclick="switchTab('feed', this)"><span
                    class="material-symbols-outlined text-[14px]">forum</span>Feed</div>
            <div class="tab-btn" onclick="switchTab('ranking', this)"><span
                    class="material-symbols-outlined text-[14px]">leaderboard</span>Classement</div>
            <div class="tab-btn" onclick="switchTab('sessions', this)"><span
                    class="material-symbols-outlined text-[14px]">surfing</span>Sessions</div>
            <div class="tab-btn" onclick="switchTab('spots', this)"><span
                    class="material-symbols-outlined text-[14px]">place</span>Spots</div>
        </div>
    </div>

    <main id="main-content" class="px-3 space-y-3 pt-3">

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB FEED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-feed" class="space-y-3">

            <!-- Widget Session du Jour -->
            <div class="relative overflow-hidden rounded-2xl p-4 flex items-center gap-3 border border-[#00bad6]/20"
                style="background:linear-gradient(135deg,rgba(0,186,214,.08),rgba(0,119,204,.04))">
                <div class="w-11 h-11 rounded-full flex items-center justify-center shrink-0 text-2xl"
                    style="background:linear-gradient(135deg,#00bad6,#0077cc)">ğŸ„</div>
                <div class="flex-1 min-w-0">
                    <p class="font-bold text-sm text-[#00bad6]">Lance une session !</p>
                    <p class="text-[10px] text-slate-400 mt-0.5">Enregistre ta session pour dÃ©bloquer des badges
                        automatiquement</p>
                </div>
                <button type="button" onclick="window.location.href='session-live.html'"
                    class="shrink-0 font-black text-sm px-4 py-2 rounded-xl transition-all text-black active:scale-95"
                    style="background:linear-gradient(135deg,#00bad6,#0077cc)">DÃ©marrer</button>
            </div>

            <!-- Topic chips -->
            <div class="flex gap-2 overflow-x-auto pb-0.5 no-scroll">
                <button type="button" class="chip active" onclick="setFilter('all',this)">ğŸŒŠ Tous</button>
                <button type="button" class="chip" onclick="setFilter('session',this)">ğŸ„ Sessions</button>
                <button type="button" class="chip" onclick="setFilter('spot',this)">ğŸ“ Spots</button>
                <button type="button" class="chip" onclick="setFilter('houle',this)">ğŸŒŠ Houle</button>
                <button type="button" class="chip" onclick="setFilter('competition',this)">ğŸ† CompÃ©tition</button>
                <button type="button" class="chip" onclick="setFilter('question',this)">â“ Questions</button>
            </div>

            <!-- Composer -->
            <div class="card rounded-2xl p-3">
                <div class="flex gap-2.5">
                    <div id="compAvatar"
                        class="w-8 h-8 rounded-full bg-[#00bad6]/20 flex items-center justify-center font-bold text-[#00bad6] text-sm shrink-0 active:scale-95 transition-transform">
                        S</div>
                    <textarea id="postText" rows="2" placeholder="Partage ta session, une houle, un spotâ€¦"
                        class="flex-1 bg-[#000] rounded-xl px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-[#00bad6]/40 border border-[#00bad6]/10 resize-none"></textarea>
                </div>
                <!-- Photo preview (hidden until image selected) -->
                <div id="photoPreview" class="hidden mt-2 relative inline-block">
                    <img loading="lazy" id="photoPreviewImg" src="" alt="preview"
                        class="max-h-32 rounded-xl object-cover border border-[#00bad6]/20" />
                    <button type="button" onclick="removePhoto()"
                        class="absolute top-1 right-1 w-5 h-5 rounded-full bg-black/70 flex items-center justify-center">
                        <span class="material-symbols-outlined text-white text-[11px]">close</span>
                    </button>
                </div>
                <div class="flex items-center gap-2 mt-2.5 flex-wrap">
                    <div class="flex gap-1.5 flex-wrap">
                        <button type="button" id="tag-session" onclick="toggleTag('session')"
                            class="post-tag text-[10px] px-2.5 py-1 rounded-full border border-white/10 text-slate-400 transition-all">ğŸ„
                            Session</button>
                        <button type="button" id="tag-spot" onclick="toggleTag('spot')"
                            class="post-tag text-[10px] px-2.5 py-1 rounded-full border border-white/10 text-slate-400 transition-all">ğŸ“
                            Spot</button>
                        <button type="button" id="tag-houle" onclick="toggleTag('houle')"
                            class="post-tag text-[10px] px-2.5 py-1 rounded-full border border-white/10 text-slate-400 transition-all">ğŸŒŠ
                            Houle</button>
                        <button type="button" id="tag-competition" onclick="toggleTag('competition')"
                            class="post-tag text-[10px] px-2.5 py-1 rounded-full border border-white/10 text-slate-400 transition-all">ğŸ†
                            CompÃ©tition</button>
                        <!-- Photo upload button -->
                        <label for="postPhotoInput"
                            class="post-tag text-[10px] px-2.5 py-1 rounded-full border border-white/10 text-slate-400 transition-all cursor-pointer hover:border-[#00bad6]/40 hover:text-[#00bad6] flex items-center gap-1">
                            <span class="material-symbols-outlined text-[12px]">add_photo_alternate</span> Photo
                        </label>
                        <input type="file" id="postPhotoInput" accept="image/*" class="hidden"
                            onchange="previewPhoto(event)" />
                    </div>
                    <button type="button" onclick="submitPost()"
                        class="ml-auto bg-[#00bad6] text-[#000] font-bold text-xs px-4 py-1.5 rounded-xl flex items-center gap-1 active:scale-95 transition-transform">
                        <span class="material-symbols-outlined text-sm">send</span>Publier
                    </button>
                </div>
            </div>

            <!-- Feed posts -->
            <!-- AdSense Slot -->
            <div class="sw-ad-slot" data-ad-slot="9633029852" data-ad-format="fluid" style="margin:0 16px 12px">
            </div>
            <div id="feed" class="space-y-2.5"></div>

        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB RANKING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-ranking" class="hidden space-y-4">
            <div class="flex items-center gap-2 mb-1">
                <span class="material-symbols-outlined text-amber-400">emoji_events</span>
                <h2 class="font-black text-base">Classement RÃ©gional</h2>
                <span class="text-[9px] bg-amber-400/20 text-amber-400 px-2 py-0.5 rounded-full font-bold ml-auto">Ce
                    mois</span>
            </div>

            <!-- Podium top 3 -->
            <div class="flex items-end justify-center gap-3 py-4">
                <!-- 2nd -->
                <div class="flex flex-col items-center gap-1">
                    <div
                        class="w-12 h-12 rounded-full bg-slate-500/30 border-2 border-slate-400 flex items-center justify-center font-black text-slate-300 text-lg">
                        M</div>
                    <span class="text-[9px] font-bold text-slate-400">MarieL</span>
                    <span class="material-symbols-outlined"
                        style="font-size:16px;color:#6b7280;font-variation-settings:'FILL' 1">anchor</span>
                    <div class="w-16 h-16 bg-slate-600/30 rounded-t-lg flex items-center justify-center text-2xl">ğŸ¥ˆ
                    </div>
                </div>
                <!-- 1er -->
                <div class="flex flex-col items-center gap-1 -mb-2">
                    <div class="w-16 h-16 rounded-full border-4 border-amber-400 flex items-center justify-center font-black text-amber-400 text-xl"
                        style="background:rgba(251,191,36,.15)">J</div>
                    <div class="flex flex-col items-center">
                        <span class="text-[10px] font-black text-amber-300">JerÃ´meS</span>
                        <span class="material-symbols-outlined"
                            style="font-size:16px;color:#ef4444;font-variation-settings:'FILL' 1;margin-top:2px">landscape</span>
                    </div>
                    <div
                        class="w-20 h-20 bg-amber-400/15 rounded-t-lg flex items-center justify-center text-3xl border border-amber-400/30">
                        ğŸ¥‡</div>
                </div>
                <!-- 3Ã¨me -->
                <div class="flex flex-col items-center gap-1">
                    <div
                        class="w-12 h-12 rounded-full bg-orange-500/20 border-2 border-orange-400 flex items-center justify-center font-black text-orange-300 text-lg">
                        A</div>
                    <span class="text-[9px] font-bold text-slate-400">AlexS29</span>
                    <span class="material-symbols-outlined"
                        style="font-size:16px;color:#6b7280;font-variation-settings:'FILL' 1">anchor</span>
                    <div class="w-14 h-10 bg-orange-500/20 rounded-t-lg flex items-center justify-center text-xl">ğŸ¥‰
                    </div>
                </div>
            </div>

            <!-- RivalitÃ© rÃ©gionale -->
            <div class="card rounded-2xl p-3">
                <p class="text-[10px] text-slate-500 font-black uppercase tracking-widest mb-3">âš”ï¸ RivalitÃ© RÃ©gionale â€”
                    Sessions ce mois</p>
                <div id="rivalieChart" class="space-y-2">
                    <div>
                        <div class="flex justify-between text-xs mb-1"><span class="font-bold">ğŸ„ Pays
                                Basque</span><span class="text-[#00bad6] font-bold">247 sessions</span></div>
                        <div class="bg-white/5 rounded-full h-2">
                            <div class="h-2 rounded-full"
                                style="width:82%;background:linear-gradient(90deg,#16a34a,#22c55e)"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-xs mb-1"><span class="font-bold">ğŸŒŠ Landes</span><span
                                class="text-[#00bad6] font-bold">201 sessions</span></div>
                        <div class="bg-white/5 rounded-full h-2">
                            <div class="h-2 rounded-full"
                                style="width:67%;background:linear-gradient(90deg,#2563eb,#3b82f6)"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-xs mb-1"><span class="font-bold">âš“ Bretagne</span><span
                                class="text-[#00bad6] font-bold">183 sessions</span></div>
                        <div class="bg-white/5 rounded-full h-2">
                            <div class="h-2 rounded-full"
                                style="width:61%;background:linear-gradient(90deg,#374151,#6b7280)"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-xs mb-1"><span class="font-bold">â˜€ï¸ CÃ´te
                                d'Azur</span><span class="text-[#00bad6] font-bold">94 sessions</span></div>
                        <div class="bg-white/5 rounded-full h-2">
                            <div class="h-2 rounded-full"
                                style="width:31%;background:linear-gradient(90deg,#0ea5e9,#38bdf8)"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Full ranking list -->
            <div class="space-y-2" id="fullRanking">
                <!-- Generated by JS -->
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB SESSIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-sessions" class="hidden space-y-3">
            <div class="flex items-center justify-between mb-1">
                <h2 class="font-black text-base">ğŸ““ Journal de Sessions</h2>
                <button type="button" onclick="openLogSession()"
                    class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-xl flex items-center gap-1 active:scale-95 transition-transform">
                    <span class="material-symbols-outlined text-sm">add</span>Loguer
                </button>
            </div>
            <div id="sessionsList" class="space-y-2.5"></div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB SPOTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-spots" class="hidden space-y-3">
            <h2 class="font-black text-base">ğŸ“ Spots signalÃ©s par la communautÃ©</h2>
            <div id="communitySpots" class="space-y-2"></div>
        </section>

    </main>

    <!-- Log Session Modal -->
    <div id="logModal" class="fixed inset-0 z-[200] hidden items-end justify-center bg-black/60 backdrop-blur-sm">
        <div class="w-full max-w-lg bg-[#111] rounded-t-3xl border-t border-[#00bad6]/20 p-5 space-y-3">
            <div class="flex items-center justify-between mb-1">
                <h3 class="font-black text-base">ğŸ““ Logger une session</h3>
                <button type="button" onclick="closeLogSession()" class="text-slate-400"><span
                        class="material-symbols-outlined">close</span></button>
            </div>
            <select id="logSpot"
                class="w-full bg-[#000] border border-[#00bad6]/20 rounded-xl px-3 py-2.5 text-sm text-white focus:outline-none focus:ring-1 focus:ring-[#00bad6]/50">
                <option value="">ğŸ“ SÃ©lectionner un spot...</option>
                <option>Hossegor â€” La GraviÃ¨re</option>
                <option>Biarritz â€” La CÃ´te des Basques</option>
                <option>La Torche â€” Bretagne</option>
                <option>Lacanau â€” Ocean</option>
                <option>Seignosse â€” Les Bourdaines</option>
            </select>
            <div class="grid grid-cols-2 gap-2">
                <div>
                    <label class="text-[10px] text-slate-400 font-bold mb-1 block">HAUTEUR VAGUES</label>
                    <select id="logWave"
                        class="w-full bg-[#000] border border-[#00bad6]/20 rounded-xl px-3 py-2 text-sm text-white focus:outline-none">
                        <option>
                            < 0.5m</option>
                        <option>0.5m â€” 1m</option>
                        <option>1m â€” 1.5m</option>
                        <option selected>1.5m â€” 2m</option>
                        <option>2m â€” 2.5m</option>
                        <option>2.5m+</option>
                    </select>
                </div>
                <div>
                    <label class="text-[10px] text-slate-400 font-bold mb-1 block">NOTE</label>
                    <select id="logScore"
                        class="w-full bg-[#000] border border-[#00bad6]/20 rounded-xl px-3 py-2 text-sm text-white focus:outline-none">
                        <option>â­â­â­â­â­ 5/5</option>
                        <option selected>â­â­â­â­ 4/5</option>
                        <option>â­â­â­ 3/5</option>
                        <option>â­â­ 2/5</option>
                        <option>â­ 1/5</option>
                    </select>
                </div>
            </div>
            <textarea id="logNote" rows="2" placeholder="Note de session (vent, foule, fondâ€¦)"
                class="w-full bg-[#000] border border-[#00bad6]/20 rounded-xl px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-[#00bad6]/40 resize-none"></textarea>
            <button type="button" onclick="submitSession()"
                class="w-full bg-[#00bad6] text-[#000] font-black py-3 rounded-xl text-sm active:scale-95 transition-transform">Enregistrer
                la
                session</button>
        </div>
    </div>

    <!-- Badge Shop Modal (Full Boutique) -->
    <div id="badgeShopModal" class="fixed inset-0 z-[200] hidden items-end justify-center bg-black/60 backdrop-blur-sm"
        style="overflow-y:auto">
        <div class="w-full max-w-lg bg-[#111] rounded-t-3xl border-t border-[#00bad6]/20 p-5 space-y-3"
            style="max-height:85vh;overflow-y:auto">
            <div class="flex items-center justify-between">
                <div>
                    <h3 class="font-black text-base">ğŸª Boutique SwellSync</h3>
                    <p class="text-[10px] text-slate-500 mt-0.5">Personnalise ton profil et tes interactions ğŸ¤™</p>
                </div>
                <button type="button" onclick="closeBadgeShop()" class="text-slate-400"><span
                        class="material-symbols-outlined">close</span></button>
            </div>

            <!-- Shop Tabs -->
            <div class="flex gap-1 bg-[#000] rounded-xl p-1">
                <button type="button" onclick="shopTab('badges')" id="shopTabBadges"
                    class="flex-1 py-2 rounded-lg text-xs font-bold bg-[#00bad6] text-[#000]">ğŸ… Badges</button>
                <button type="button" onclick="shopTab('stickers')" id="shopTabStickers"
                    class="flex-1 py-2 rounded-lg text-xs font-bold text-slate-400">ğŸ’¬ Stickers</button>
                <button type="button" onclick="shopTab('profil')" id="shopTabProfil"
                    class="flex-1 py-2 rounded-lg text-xs font-bold text-slate-400">âœ¨ Profil</button>
            </div>

            <!-- TAB: Badges -->
            <div id="shopPanelBadges" class="space-y-2">
                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">RÃ©gionaux</p>
                <div class="space-y-2">
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#ef4444,#b91c1c)">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">landscape</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold">Badge Pays Basque</p>
                            <p class="text-[10px] text-slate-500">ReprÃ©sente la cÃ´te basque ğŸ„</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#16a34a,#15803d)">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">forest</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold">Badge Landes</p>
                            <p class="text-[10px] text-slate-500">Surfeur des Landes ğŸŒ²</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#111827,#374151);border:1px solid #6b7280">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">anchor</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold">Badge Bretagne</p>
                            <p class="text-[10px] text-slate-500">Surfeur breton âš“</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#f97316,#ea580c)">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">volcano</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold">Badge La RÃ©union</p>
                            <p class="text-[10px] text-slate-500">Surfeur rÃ©unionnais ğŸŒ´</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#06b6d4,#0891b2)">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">beach_access</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold">Badge Guadeloupe</p>
                            <p class="text-[10px] text-slate-500">Surfeur caribÃ©en ğŸï¸</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                </div>
                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest pt-2">CompÃ©tition & Style</p>
                <div class="space-y-2">
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#00bad6,#0891b2)">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">surfing</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold">Badge Shortboard</p>
                            <p class="text-[10px] text-slate-500">Specialist shortboard ğŸ„â€â™‚ï¸</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3" style="border-color:rgba(245,158,11,.3)">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#f59e0b,#d97706)">
                            <span class="material-symbols-outlined text-[#000] text-xl"
                                style="font-variation-settings:'FILL' 1">military_tech</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold text-amber-300">Badge Elite</p>
                            <p class="text-[10px] text-slate-500">Exclusif â€” Surfeur d'Ã©lite âš¡</p>
                        </div>
                        <button type="button"
                            class="font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform text-black"
                            style="background:linear-gradient(135deg,#f59e0b,#d97706)"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3" style="border-color:rgba(168,85,247,.3)">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center"
                            style="background:linear-gradient(135deg,#7c3aed,#a855f7)">
                            <span class="material-symbols-outlined text-white text-xl"
                                style="font-variation-settings:'FILL' 1">workspace_premium</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-xs font-bold text-purple-300">Badge Pro Star â­</p>
                            <p class="text-[10px] text-slate-500">Badge Pro officiel SwellSync</p>
                        </div>
                        <button type="button"
                            class="font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform text-white"
                            style="background:linear-gradient(135deg,#7c3aed,#a855f7)"
                            onclick="window.location.href='badges.html'">Ã‰quiper â†’</button>
                    </div>
                </div>
            </div>

            <!-- TAB: Stickers (quick reactions for posts) -->
            <div id="shopPanelStickers" class="hidden space-y-3">
                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">RÃ©actions rapides pour les
                    posts</p>
                <p class="text-[10px] text-slate-400">Ajoute des rÃ©actions uniques sur les posts de la communautÃ©</p>

                <p class="text-[9px] text-[#00bad6] font-bold uppercase mt-2">ğŸ„ Surf</p>
                <div class="grid grid-cols-4 gap-2">
                    <button type="button" onclick="buySticker('ğŸ¤™','Shaka')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ¤™</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Shaka</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ„','Surfeur')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ„</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Surfeur</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸŒŠ','Big Wave')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸŒŠ</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Big Wave</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ”¥','En Feu')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ”¥</span>
                        <span class="text-[9px] text-slate-400 block mt-1">En Feu</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                </div>

                <p class="text-[9px] text-[#00bad6] font-bold uppercase mt-2">â˜€ï¸ MÃ©tÃ©o & Conditions</p>
                <div class="grid grid-cols-4 gap-2">
                    <button type="button" onclick="buySticker('â˜€ï¸','Soleil')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">â˜€ï¸</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Soleil</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ’¨','Offshore')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ’¨</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Offshore</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸŒ…','Sunset')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸŒ…</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Sunset</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ¦ˆ','Shark!')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ¦ˆ</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Shark!</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                </div>

                <p class="text-[9px] text-[#00bad6] font-bold uppercase mt-2">ğŸ‰ CÃ©lÃ©bration</p>
                <div class="grid grid-cols-4 gap-2">
                    <button type="button" onclick="buySticker('ğŸ†','Champ')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ†</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Champ</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ’ª','Strong')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ’ª</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Strong</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ˜','Love It')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ˜</span>
                        <span class="text-[9px] text-slate-400 block mt-1">Love It</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buySticker('ğŸ¯','PrÃ©cis')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <span class="text-2xl block">ğŸ¯</span>
                        <span class="text-[9px] text-slate-400 block mt-1">PrÃ©cis</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                </div>

                <!-- Pack promo -->
                <div class="card rounded-xl p-3 flex items-center gap-3 mt-2" style="border-color:rgba(0,186,214,.3)">
                    <div class="text-xl">ğŸ“¦</div>
                    <div class="flex-1">
                        <p class="text-xs font-bold text-[#00bad6]">Pack 12 Stickers</p>
                        <p class="text-[10px] text-slate-500">Tous les stickers d'un coup !</p>
                    </div>
                    <div class="text-right">
                        <span class="text-[10px] text-slate-500 line-through">5,88â‚¬</span>
                        <button type="button"
                            class="block bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform mt-0.5"
                            onclick="buySticker(arguments[0])">ğŸ‘ RÃ©agir</button>
                    </div>
                </div>
            </div>

            <!-- TAB: Profil (frames, auras, effects) -->
            <div id="shopPanelProfil" class="hidden space-y-3">
                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">Cadres de profil</p>
                <p class="text-[10px] text-slate-400">Un cadre autour de ton avatar dans la communautÃ©</p>

                <div class="grid grid-cols-3 gap-2">
                    <button type="button" onclick="buyFrame('ocean')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <div class="w-12 h-12 rounded-full mx-auto mb-1.5 flex items-center justify-center text-lg font-black"
                            style="border:3px solid #00bad6;background:rgba(0,186,214,.15)">S</div>
                        <span class="text-[9px] text-slate-300 font-bold block">Ocean</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buyFrame('fire')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <div class="w-12 h-12 rounded-full mx-auto mb-1.5 flex items-center justify-center text-lg font-black"
                            style="border:3px solid #f97316;background:rgba(249,115,22,.15)">S</div>
                        <span class="text-[9px] text-slate-300 font-bold block">Fire</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buyFrame('gold')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <div class="w-12 h-12 rounded-full mx-auto mb-1.5 flex items-center justify-center text-lg font-black"
                            style="border:3px solid #f59e0b;background:rgba(245,158,11,.15)">S</div>
                        <span class="text-[9px] text-slate-300 font-bold block">Gold</span>
                        <span class="text-[9px] text-amber-400 font-bold block">1,49â‚¬</span>
                    </button>
                    <button type="button" onclick="buyFrame('rainbow')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <div class="w-12 h-12 rounded-full mx-auto mb-1.5 flex items-center justify-center text-lg font-black"
                            style="border:3px solid;border-image:linear-gradient(135deg,#f43f5e,#8b5cf6,#00bad6) 1;border-radius:50%;background:rgba(139,92,246,.1)">
                            S</div>
                        <span class="text-[9px] text-slate-300 font-bold block">Rainbow</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buyFrame('neon')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <div class="w-12 h-12 rounded-full mx-auto mb-1.5 flex items-center justify-center text-lg font-black"
                            style="border:3px solid #22d3ee;box-shadow:0 0 8px rgba(34,211,238,.5);background:rgba(34,211,238,.1)">
                            S</div>
                        <span class="text-[9px] text-slate-300 font-bold block">Neon</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                    <button type="button" onclick="buyFrame('diamond')"
                        class="card rounded-xl p-3 text-center hover:border-[#00bad6]/40 transition-all active:scale-95">
                        <div class="w-12 h-12 rounded-full mx-auto mb-1.5 flex items-center justify-center text-lg font-black"
                            style="border:3px solid #e2e8f0;box-shadow:0 0 12px rgba(226,232,240,.4);background:rgba(226,232,240,.08)">
                            S</div>
                        <span class="text-[9px] text-slate-300 font-bold block">Diamond ğŸ’</span>
                        <span class="text-[9px] text-emerald-400 font-bold block">Gratuit ğŸ¨</span>
                    </button>
                </div>

                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest pt-2">Effets de nom</p>
                <div class="space-y-2">
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <span class="text-sm font-black"
                            style="background:linear-gradient(90deg,#00bad6,#22d3ee);-webkit-background-clip:text;-webkit-text-fill-color:transparent">SwellSurfer</span>
                        <div class="flex-1">
                            <p class="text-[10px] text-slate-500">Nom en dÃ©gradÃ© ocean</p>
                        </div>
                        <button type="button"
                            class="bg-[#00bad6] text-[#000] font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform"
                            onclick="buyEffect('gradient')">Gratuit ğŸŒˆ</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3">
                        <span class="text-sm font-black"
                            style="background:linear-gradient(90deg,#f59e0b,#f97316);-webkit-background-clip:text;-webkit-text-fill-color:transparent">SwellSurfer</span>
                        <div class="flex-1">
                            <p class="text-[10px] text-slate-500">Nom en dÃ©gradÃ© fire</p>
                        </div>
                        <button type="button"
                            class="font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform text-black"
                            style="background:linear-gradient(135deg,#f59e0b,#f97316)"
                            onclick="buyEffect('fire')">Gratuit ğŸ”¥</button>
                    </div>
                    <div class="flex items-center gap-3 card rounded-xl p-3" style="border-color:rgba(168,85,247,.2)">
                        <span class="text-sm font-black"
                            style="background:linear-gradient(90deg,#a855f7,#ec4899,#f43f5e);-webkit-background-clip:text;-webkit-text-fill-color:transparent">SwellSurfer
                            âœ¨</span>
                        <div class="flex-1">
                            <p class="text-[10px] text-slate-500">Nom arc-en-ciel + sparkle</p>
                        </div>
                        <button type="button"
                            class="font-bold text-xs px-3 py-1.5 rounded-lg active:scale-95 transition-transform text-white"
                            style="background:linear-gradient(135deg,#a855f7,#ec4899)"
                            onclick="buyEffect('rainbow')">Gratuit âœ¨</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reply Modal -->
    <div id="replyModal" class="fixed inset-0 z-[200] hidden items-end justify-center bg-black/60 backdrop-blur-sm">
        <div class="w-full max-w-lg bg-[#111] rounded-t-3xl border-t border-[#00bad6]/20 p-5 space-y-3">
            <div class="flex items-center justify-between">
                <h3 class="font-black text-sm">ğŸ’¬ RÃ©pondre</h3>
                <button type="button" onclick="closeReplyModal()" class="text-slate-400"><span
                        class="material-symbols-outlined text-lg">close</span></button>
            </div>
            <div id="replyContext" class="reply-box text-xs text-slate-400"></div>
            <div class="flex gap-2.5">
                <div
                    class="w-8 h-8 rounded-full bg-[#00bad6]/20 flex items-center justify-center font-bold text-[#00bad6] text-sm shrink-0 active:scale-95 transition-transform">
                    S</div>
                <textarea id="replyText" rows="3" placeholder="Ta rÃ©ponseâ€¦"
                    class="flex-1 bg-[#000] rounded-xl px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-[#00bad6]/40 border border-[#00bad6]/10 resize-none"></textarea>
            </div>
            <button type="button" onclick="submitReply()"
                class="w-full bg-[#00bad6] text-[#000] font-black py-3 rounded-xl text-sm active:scale-95 transition-transform">Publier
                la
                rÃ©ponse</button>
        </div>
    </div>

    <!-- Bottom Nav -->
    <nav class="fixed bottom-0 left-0 right-0 border-t border-[#00bad6]/20 pb-6 pt-2 px-2 flex justify-between items-center z-50 backdrop-blur-lg transition-colors duration-300"
        style="background: var(--nav-bg, rgba(8,15,26,0.95))">
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="home.html"><span
                class="material-symbols-outlined">home</span><span class="text-[10px]">Home</span>

        </a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="map.html"><span
                class="material-symbols-outlined">travel_explore</span><span class="text-[10px]">Spots</span></a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="alerts.html"><span
                class="material-symbols-outlined">notifications</span><span class="text-[10px]">Alertes</span></a>
        <a class="flex flex-col items-center gap-1 text-[#00bad6] flex-1" href="community.html"><span
                class="material-symbols-outlined" style="font-variation-settings:\'FILL\' 1">groups</span><span
                class="text-[10px] font-bold">CommunautÃ©</span>
            <div class="w-1 h-1 bg-[#00bad6] rounded-full mt-0.5 active:scale-95 transition-transform"></div>
        </a>
        <a class="flex flex-col items-center gap-1 text-slate-500 flex-1" href="profile.html"><span
                class="material-symbols-outlined">person</span><span class="text-[10px]">Profil</span></a>
    </nav>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // DATA
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const BADGES = {
            'Pays Basque': { icon: 'landscape', gradient: 'linear-gradient(135deg,#ef4444,#b91c1c)', label: 'Pays Basque' },
            'Landes': { icon: 'forest', gradient: 'linear-gradient(135deg,#16a34a,#15803d)', label: 'Landes' },
            'Bretagne': { icon: 'anchor', gradient: 'linear-gradient(135deg,#111827,#374151)', label: 'Bretagne' },
            'RÃ©union': { icon: 'volcano', gradient: 'linear-gradient(135deg,#f97316,#ea580c)', label: 'La RÃ©union' },
            'Guadeloupe': { icon: 'beach_access', gradient: 'linear-gradient(135deg,#06b6d4,#0891b2)', label: 'Guadeloupe' },
            'Shortboard': { icon: 'surfing', gradient: 'linear-gradient(135deg,#00bad6,#0891b2)', label: 'Shortboard' },
            'Elite': { icon: 'military_tech', gradient: 'linear-gradient(135deg,#f59e0b,#d97706)', label: 'Elite' },
            'Pro': { icon: 'workspace_premium', gradient: 'linear-gradient(135deg,#7c3aed,#a855f7)', label: 'Pro Star' },
        };

        let POSTS = [
            {
                id: 1, user: 'JerÃ´meS', av: 'J', color: 'bg-[#00bad6]/20 text-[#00bad6]', badges: ['Pays Basque'], tag: 'session', time: '2min',
                text: 'Session incroyable Ã  Hossegor ce matin ğŸ”¥ 2m+ de houle, vent offshore parfait Ã  20km/h. La GraviÃ¨re Ã©tait Ã©pique !',
                img: 'https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=800&q=80',
                likes: 12, liked: false, replies: [{ user: 'MarieLR', text: 'Trop jalouse ! Quelle heure tu y Ã©tais ? ğŸ˜', time: '1min' }]
            },
            {
                id: 2, user: 'MarieLR', av: 'M', color: 'bg-purple-500/20 text-purple-400', badges: ['Bretagne'], tag: 'question', time: '18min',
                text: "Quelqu'un a des infos sur La Torche ce week-end ? ğŸ„â€â™€ï¸ Je prÃ©vois d'y aller samedi matin.",
                likes: 5, liked: false, replies: [{ user: 'AlexS29', text: "Conditions annoncÃ©es 1.5m propre, foule modÃ©rÃ©e samedi matin !", time: '15min' }]
            },
            {
                id: 3, user: 'AlexSurf29', av: 'A', color: 'bg-emerald-500/20 text-emerald-400', badges: ['Bretagne'], tag: 'houle', time: '1h',
                text: 'Houle 2.8m prÃ©vue vendredi sur la cÃ´te basque selon Stormglass. Qui sera Ã  Hossegor ? ğŸ¤™',
                likes: 23, liked: false, replies: []
            },
            {
                id: 4, user: 'SurfGuide64', av: 'S', color: 'bg-amber-500/20 text-amber-400', badges: ['Landes'], tag: 'spot', time: '2h',
                text: 'Note session Bidart 7/10 â€” Fond sable parfait, mais foule au pic. Allez plutÃ´t Ã  7h du matin pour Ã©viter la foule.',
                img: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&q=80',
                likes: 18, liked: false, replies: [{ user: 'JÃ©rÃ´meS', text: 'Confirme ! 6h30-9h c\'est le paradis Ã  Bidart', time: '1h50' }]
            },
            {
                id: 5, user: 'BretagneSurf', av: 'B', color: 'bg-red-500/20 text-red-400', badges: ['Bretagne'], tag: 'session', time: '3h',
                text: 'La Palue absolument vide hier avec 1.5m propre ğŸ˜ Seuls 4 surfeurs Ã  l\'eau. Bretagne > tout le reste !',
                likes: 31, liked: false, replies: []
            },
            {
                id: 6, user: 'WSL_Follow', av: 'W', color: 'bg-red-600/20 text-red-500', badges: ['WSL'], tag: 'competition', time: '5h',
                text: 'ğŸ† RÃ©sultats Quik Pro France : Kelly Slater en 1/4 de finale ! Hossegor en feu cette semaine ğŸ”¥ğŸ”¥',
                likes: 67, liked: false, replies: []
            },
        ];

        // SESSIONS â€” chargÃ©es depuis Supabase surf_sessions
        let SESSIONS = [];
        (async () => {
            try {
                const SB_URL = 'https://bxudysseskfpmlpagoid.supabase.co';
                const SB_KEY = 'sb_publishable_8UPKYf9eOQjX9-5bBGl1CA_XRu8ZkiU';
                const sbClient = window.supabase?.createClient?.(SB_URL, SB_KEY);
                const { data: { session } } = sbClient ? await sbClient.auth.getSession() : { data: {} };
                const token = session?.access_token || SB_KEY;
                const res = await fetch(
                    `${SB_URL}/rest/v1/surf_sessions?select=*&order=started_at.desc&limit=20`,
                    { headers: { 'apikey': SB_KEY, 'Authorization': 'Bearer ' + token } }
                );
                if (res.ok) {
                    const rows = await res.json();
                    SESSIONS = rows.map(s => ({
                        id: s.id,
                        spot: s.spot_name || 'Spot',
                        wave: s.wave_height ? s.wave_height + 'm' : 'â€”',
                        score: 'â­'.repeat(Math.min(5, Math.round((s.score || 0) / 2))) || 'â­â­â­',
                        date: s.started_at ? new Date(s.started_at).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' }) : 'â€”',
                        note: s.notes || ''
                    }));
                    // Re-render si tab sessions actif
                    if (document.getElementById('tab-sessions') && !document.getElementById('tab-sessions').classList.contains('hidden')) {
                        renderSessions();
                    }
                }
            } catch { }
        })();

        // â”€â”€ Classement rÃ©el depuis Supabase (surf_sessions) â”€â”€
        // ChargÃ© dynamiquement dans renderRanking()



        let currentFilter = 'all';
        let activeTag = null;
        let replyingToId = null;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // TABS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function switchTab(tab, el) {
            document.querySelectorAll('[id^="tab-"]').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.remove('hidden');
            el.classList.add('active');
            if (tab === 'ranking') renderRanking();
            if (tab === 'sessions') renderSessions();
            if (tab === 'spots') renderCommunitySpots();
        }

        // Monthly rotation seed
        function monthSeed() {
            const d = new Date();
            return d.getFullYear() * 100 + d.getMonth();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // BADGE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function badgeHtml(b) {
            const bd = BADGES[b];
            if (!bd) return '';
            return `<span class="material-symbols-outlined" style="font-size:16px;display:inline-block;vertical-align:middle;flex-shrink:0;font-variation-settings:'FILL' 1;background:${bd.gradient};-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text" title="${bd.label}">${bd.icon}</span>`;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FILTER + FEED
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function setFilter(f, el) {
            currentFilter = f;
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            renderFeed();
        }

        function toggleTag(t) {
            activeTag = activeTag === t ? null : t;
            document.querySelectorAll('.post-tag').forEach(b => {
                b.classList.remove('bg-[#00bad6]/20', 'text-[#00bad6]', 'border-[#00bad6]/40');
                b.classList.add('text-slate-400');
            });
            if (activeTag) {
                const el = document.getElementById('tag-' + activeTag);
                if (el) { el.classList.add('bg-[#00bad6]/20', 'text-[#00bad6]', 'border-[#00bad6]/40'); el.classList.remove('text-slate-400'); }
            }
        }

        function tagLabel(t) { return { session: 'ğŸ„ Session', spot: 'ğŸ“ Spot', houle: 'ğŸŒŠ Houle', competition: 'ğŸ† CompÃ©tition', question: 'â“ Question' }[t] || t; }

        function renderFeed() {
            const posts = currentFilter === 'all' ? POSTS : POSTS.filter(p => p.tag === currentFilter);
            document.getElementById('feed').innerHTML = posts.map(p => postHtml(p)).join('');
        }

        function postHtml(p) {
            const repliesHtml = p.replies.map(r => `
        <div class="reply-box flex gap-2 mt-2">
            <div class="w-5 h-5 rounded-full bg-slate-600 flex items-center justify-center text-[9px] font-bold text-slate-300 shrink-0">${r.user[0]}</div>
            <div class="flex-1">
                <span class="text-[10px] font-bold text-slate-300">${r.user}</span>
                <span class="text-[9px] text-slate-500 ml-1">${r.time}</span>
                <p class="text-[11px] text-slate-300 mt-0.5">${r.text}</p>
            </div>
        </div>`).join('');

            const imgHtml = p.img ? `
        <div class="rounded-xl overflow-hidden mt-1 cursor-pointer relative group" onclick="openLightbox('${p.img}')">
            <img src="${p.img}" alt="Post photo" loading="lazy"
                class="w-full max-h-64 object-cover rounded-xl transition-transform group-hover:scale-[1.02]"/>
            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors rounded-xl flex items-center justify-center">
                <span class="material-symbols-outlined text-white text-2xl opacity-0 group-hover:opacity-80 transition-opacity">zoom_in</span>
            </div>
        </div>` : '';

            return `<div class="post-enter card rounded-2xl p-3.5 space-y-2.5" id="post-${p.id}">
        <div class="flex items-start gap-2.5">
            <div class="w-9 h-9 rounded-full ${p.color} flex items-center justify-center font-black shrink-0 text-sm">${p.av}</div>
            <div class="flex-1 min-w-0">
                <div class="flex items-center gap-1.5 flex-wrap">
                    <span class="font-black text-sm">${p.user}</span>
                    ${p.badges.map(badgeHtml).join('')}
                    <span class="text-[9px] text-slate-500 ml-auto shrink-0">${p.time}</span>
                </div>
                <span class="text-[9px] bg-[#00bad6]/10 text-[#00bad6] px-2 py-0.5 rounded-full font-semibold mt-1 inline-block active:scale-95 transition-transform">${tagLabel(p.tag)}</span>
                ${p.text ? `<p class="text-sm text-slate-200 mt-1.5 leading-relaxed">${p.text}</p>` : ''}
            </div>
        </div>
        ${imgHtml}
        ${repliesHtml}
        <div class="flex items-center gap-4 pt-1 border-t border-white/5">
            <button type="button" onclick="toggleLike(${p.id}, this)" class="like-btn flex items-center gap-1.5 text-[11px] ${p.liked ? 'text-red-400 liked' : 'text-slate-400'} hover:text-red-400 transition-colors">
                <span class="material-symbols-outlined text-[16px]" style="font-variation-settings:'FILL' ${p.liked ? 1 : 0}">${p.liked ? 'favorite' : 'favorite_border'}</span>
                <span class="like-count">${p.likes + (p.liked ? 0 : 0)}</span>
            </button>
            <button type="button" onclick="openReplyModal(${p.id})" class="flex items-center gap-1.5 text-[11px] text-slate-400 hover:text-[#00bad6] transition-colors">
                <span class="material-symbols-outlined text-[16px]">chat_bubble_outline</span>
                <span>${p.replies.length}</span>
            </button>
            <button type="button" onclick="sharePost(${p.id})" class="flex items-center gap-1.5 text-[11px] text-slate-400 hover:text-[#00bad6] transition-colors ml-auto">
                <span class="material-symbols-outlined text-[16px]">share</span>
                Partager
            </button>
        </div>
    </div>`;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ACTIONS: LIKE / REPLY / SHARE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function toggleLike(postId, btn) {
            const p = POSTS.find(x => x.id === postId);
            if (!p) return;
            p.liked = !p.liked;
            p.likes += p.liked ? 1 : -1;
            const countEl = btn.querySelector('.like-count');
            if (countEl) countEl.textContent = p.likes;
            btn.classList.toggle('liked', p.liked);
            const icon = btn.querySelector('.material-symbols-outlined');
            if (icon) { icon.style.fontVariationSettings = p.liked ? "'FILL' 1" : "'FILL' 0"; icon.textContent = p.liked ? 'favorite' : 'favorite_border'; }
            btn.style.color = p.liked ? '#f43f5e' : '';
        }

        function openReplyModal(postId) {
            replyingToId = postId;
            const p = POSTS.find(x => x.id === postId);
            if (!p) return;
            document.getElementById('replyContext').innerHTML = `<span class="font-bold text-slate-300">${p.user}:</span> ${p.text.substring(0, 80)}${p.text.length > 80 ? 'â€¦' : ''}`;
            document.getElementById('replyText').value = '';
            document.getElementById('replyModal').classList.replace('hidden', 'flex');
        }
        function closeReplyModal() { document.getElementById('replyModal').classList.replace('flex', 'hidden'); replyingToId = null; }

        function submitReply() {
            const text = document.getElementById('replyText').value.trim();
            if (!text || !replyingToId) return;
            const p = POSTS.find(x => x.id === replyingToId);
            if (!p) return;
            p.replies.push({ user: 'Moi', text, time: 'maintenant' });
            closeReplyModal();
            renderFeed();
        }

        function sharePost(postId) {
            const p = POSTS.find(x => x.id === postId);
            if (!p) return;
            const shareUrl = `${window.location.origin}/pages/community.html#post-${postId}`;
            if (navigator.share) {
                navigator.share({ title: 'SwellSync CommunautÃ©', text: `${p.user}: ${p.text}`, url: shareUrl }).catch(() => { });
            } else {
                navigator.clipboard.writeText(shareUrl).then(() => showToast('Lien copiÃ© ! ğŸ”—', 'success'));
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SUBMIT POST
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Photo upload
        let pendingPhotoUrl = null;
        function previewPhoto(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = ev => {
                pendingPhotoUrl = ev.target.result;
                document.getElementById('photoPreviewImg').src = pendingPhotoUrl;
                document.getElementById('photoPreview').classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }
        function removePhoto() {
            pendingPhotoUrl = null;
            document.getElementById('postPhotoInput').value = '';
            document.getElementById('photoPreview').classList.add('hidden');
            document.getElementById('photoPreviewImg').src = '';
        }

        function submitPost() {
            const text = document.getElementById('postText').value.trim();
            if (!text && !pendingPhotoUrl) return;
            POSTS.unshift({
                id: Date.now(), user: 'Moi', av: 'M',
                color: 'bg-[#00bad6]/20 text-[#00bad6]', badges: [],
                tag: activeTag || 'session', time: 'maintenant',
                text: text || '', likes: 0, liked: false, replies: [],
                img: pendingPhotoUrl || null
            });
            document.getElementById('postText').value = '';
            removePhoto();
            activeTag = null;
            document.querySelectorAll('.post-tag').forEach(b => { b.classList.remove('bg-[#00bad6]/20', 'text-[#00bad6]', 'border-[#00bad6]/40'); b.classList.add('text-slate-400'); });
            renderFeed();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // RANKING â€” Classement rÃ©el depuis Supabase
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        async function renderRanking() {
            const fullRankEl = document.getElementById('fullRanking');
            if (!fullRankEl) return;
            const monthName = new Date().toLocaleString('fr-FR', { month: 'long', year: 'numeric' });

            fullRankEl.innerHTML = `<div class="card rounded-2xl p-4 animate-pulse"><p class="text-xs text-slate-500 text-center">Chargement du classementâ€¦</p></div>`;

            try {
                const SB_URL = 'https://bxudysseskfpmlpagoid.supabase.co';
                const SB_KEY = 'sb_publishable_8UPKYf9eOQjX9-5bBGl1CA_XRu8ZkiU';

                // Premier mois courant : calculer debuts
                const now = new Date();
                const monthStart = new Date(now.getFullYear(), now.getMonth(), 1).toISOString();

                // AgrÃ©ger sessions par user_id ce mois-ci
                const r = await fetch(
                    `${SB_URL}/rest/v1/surf_sessions?select=user_id,score,members(pseudo,avatar_url,region)&created_at=gte.${monthStart}&order=score.desc&limit=20`,
                    { headers: { 'apikey': SB_KEY } }
                );
                const sessions = r.ok ? await r.json() : [];

                // Grouper par user_id, additionner scores
                const byUser = {};
                sessions.forEach(s => {
                    const uid = s.user_id;
                    if (!byUser[uid]) byUser[uid] = { ...s.members, uid, sessions: 0, score: 0 };
                    byUser[uid].sessions += 1;
                    byUser[uid].score += s.score || 0;
                });

                const ranked = Object.values(byUser).sort((a, b) => b.score - a.score || b.sessions - a.sessions).slice(0, 8);

                if (!ranked.length) {
                    fullRankEl.innerHTML = `<div class="card rounded-2xl p-6 text-center">
                        <div class="text-3xl mb-2">ğŸ†</div>
                        <p class="text-sm font-bold text-slate-300">Classement vide pour l'instant</p>
                        <p class="text-xs text-slate-500 mt-1">Enregistre des sessions pour apparaÃ®tre ici !</p>
                    </div>`;
                    return;
                }

                fullRankEl.innerHTML = `<div class="card rounded-2xl p-3 mb-1">
                    <p class="text-[10px] text-slate-500 font-black uppercase tracking-widest mb-2">ğŸ“Š Suite du classement â€” ${monthName}</p>
                    ${ranked.slice(3).map((u, i) => {
                    const initiale = (u.pseudo || '?')[0].toUpperCase();
                    return `<div class="flex items-center gap-3 py-2.5 border-b border-white/5 last:border-0 cursor-pointer hover:bg-[#00bad6]/5 rounded-lg transition-colors px-1 active:scale-95" onclick="window.location.href='user-profile.html?id=${u.uid}'">
                            <span class="text-slate-400 font-black text-sm w-6 text-center shrink-0">${i + 4}</span>
                            <div class="w-8 h-8 rounded-full bg-[#00bad6]/20 flex items-center justify-center font-black text-sm shrink-0 overflow-hidden">
                                ${u.avatar_url ? `<img src="${u.avatar_url}" class="w-full h-full object-cover" loading="lazy" decoding="async">` : `<span class="text-[#00bad6]">${initiale}</span>`}
                            </div>
                            <div class="flex-1 min-w-0">
                                <span class="font-bold text-sm">${u.pseudo || 'Surfeur'}</span>
                                <p class="text-[9px] text-slate-500">${u.region || 'â€”'} Â· ${u.sessions} sessions</p>
                            </div>
                            <div class="text-right shrink-0">
                                <span class="text-[#00bad6] font-bold text-sm">${u.score}</span>
                                <p class="text-[9px] text-slate-500">pts</p>
                            </div>
                        </div>`;
                }).join('')}
                </div>`;

            } catch {
                fullRankEl.innerHTML = `<p class="text-center text-slate-500 text-sm p-4">Classement temporairement indisponible.</p>`;
            }
        }


        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SESSIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function renderSessions() {
            document.getElementById('sessionsList').innerHTML = SESSIONS.map(s => `
        <div class="card rounded-2xl p-3.5 flex gap-3 items-start">
            <div class="w-10 h-10 rounded-xl bg-[#00bad6]/20 flex items-center justify-center shrink-0 active:scale-95 transition-transform"><span class="material-symbols-outlined text-[#00bad6] text-[20px]">surfing</span></div>
            <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between"><span class="font-bold text-sm truncate">${s.spot}</span><span class="text-[9px] text-slate-500 shrink-0">${s.date}</span></div>
                <div class="flex items-center gap-2 mt-1"><span class="text-[#00bad6] text-xs font-bold">${s.wave}</span><span class="text-slate-500 text-xs">Â·</span><span class="text-xs">${s.score}</span></div>
                <p class="text-[11px] text-slate-400 mt-1">${s.note}</p>
            </div>
        </div>`).join('');
        }

        function openLogSession() { document.getElementById('logModal').classList.replace('hidden', 'flex'); }
        function closeLogSession() { document.getElementById('logModal').classList.replace('flex', 'hidden'); }
        function submitSession() {
            const spot = document.getElementById('logSpot').value, wave = document.getElementById('logWave').value, score = document.getElementById('logScore').value, note = document.getElementById('logNote').value;
            if (!spot) { showToast('Choisis un spot !', 'warning'); return; }
            SESSIONS.unshift({ id: Date.now(), spot, wave, score, date: 'maintenant', note: note || 'â€”' });
            closeLogSession(); renderSessions();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // COMMUNITY SPOTS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function renderCommunitySpots() {
            const spots = [
                { name: 'Hossegor â€” La GraviÃ¨re', loc: 'Landes', cond: 'Excellent', h: '2.5m', reports: 14, rating: '4.9' },
                { name: 'Biarritz â€” CÃ´te des Basques', loc: 'Pays Basque', cond: 'Bon', h: '1.2m', reports: 8, rating: '4.2' },
                { name: 'La Torche', loc: 'Bretagne', cond: 'Correct', h: '1.8m', reports: 6, rating: '3.8' },
                { name: 'Lacanau Ocean', loc: 'Gironde', cond: 'Bon', h: '1.5m', reports: 9, rating: '4.1' },
                { name: 'Seignosse â€” Les Bourdaines', loc: 'Landes', cond: 'Excellent', h: '2.1m', reports: 11, rating: '4.7' },
            ];
            const condColor = c => ({ Excellent: 'text-emerald-400', Bon: 'text-[#00bad6]', Correct: 'text-amber-400', Mauvais: 'text-red-400' }[c] || 'text-slate-400');
            document.getElementById('communitySpots').innerHTML = spots.map(s => `
        <div class="card rounded-2xl p-3.5 flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-[#00bad6]/15 flex items-center justify-center shrink-0 active:scale-95 transition-transform"><span class="material-symbols-outlined text-[#00bad6]">place</span></div>
            <div class="flex-1 min-w-0"><p class="font-bold text-sm truncate">${s.name}</p><p class="text-[10px] text-slate-400">${s.loc}</p><div class="flex items-center gap-2 mt-0.5"><span class="text-xs font-bold ${condColor(s.cond)}">${s.cond}</span><span class="text-slate-500 text-xs">Â·</span><span class="text-xs text-[#00bad6] font-bold">${s.h}</span></div></div>
            <div class="text-right shrink-0"><span class="text-amber-400 font-bold text-sm">â˜… ${s.rating}</span><p class="text-[9px] text-slate-500">${s.reports} rapports</p></div>
        </div>`).join('');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // BADGE SHOP
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function showBadgeShop() { document.getElementById('badgeShopModal').classList.replace('hidden', 'flex'); }
        function closeBadgeShop() { document.getElementById('badgeShopModal').classList.replace('flex', 'hidden'); }
        function buyBadge(name, price) {
            const btn = event.target;
            const origText = btn.textContent;
            btn.textContent = 'â³...';
            btn.disabled = true;

            fetch('/api/stripe/buy-badge', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include',
                body: JSON.stringify({
                    badge_id: name.toLowerCase().replace(/\s+/g, '_'),
                    badge_name: name,
                    price: price
                })
            })
                .then(r => r.json())
                .then(data => {
                    if (data.url) {
                        // Rediriger vers Stripe Checkout
                        window.location.href = data.url;
                    } </h3>
                        <p class="text-2xl font-black text-[#00bad6] mb-2">${price.toFixed(2)}â‚¬</p>
                        <p class="text-sm text-slate-400 mb-4">Connecte-toi pour acheter ce badge via Stripe.</p>
                        <button type="button" onclick="this.closest('.fixed').remove()" class="w-full py-3 rounded-2xl bg-[#00bad6] font-black text-sm text-[#000] active:scale-95 transition-transform">Compris !</button>
                    </div>`;
                        document.body.appendChild(m);
                        m.addEventListener('click', e => { if (e.target === m) m.remove(); });
                    } else {
                        showToast(data.error || 'Erreur paiement', 'error');
                    }
                })
                .catch(() => showToast('Erreur rÃ©seau', 'error'))
                .finally(() => {
                    btn.textContent = origText;
                    btn.disabled = false;
                });
        }
        function unlockBadge() { showBadgeShop(); }

        function shopTab(tab) {
            ['badges', 'stickers', 'profil'].forEach(t => {
                document.getElementById('shopPanel' + t.charAt(0).toUpperCase() + t.slice(1)).classList.toggle('hidden', t !== tab);
                const btn = document.getElementById('shopTab' + t.charAt(0).toUpperCase() + t.slice(1));
                if (t === tab) { btn.className = 'flex-1 py-2 rounded-lg text-xs font-bold bg-[#00bad6] text-[#000]'; }
                else { btn.className = 'flex-1 py-2 rounded-lg text-xs font-bold text-slate-400'; }
            });
        }

        function buySticker(emoji, name) {
            const price = emoji === 'all' ? 2.99 : 0.49;
            showPurchaseModal('Sticker ' + name, emoji === 'all' ? 'ğŸ“¦' : emoji, price);
        }
        function buyFrame(type) {
            const prices = { ocean: 0.99, fire: 0.99, gold: 1.49, rainbow: 1.99, neon: 1.99, diamond: 2.99 };
            showPurchaseModal('Cadre ' + type.charAt(0).toUpperCase() + type.slice(1), 'ğŸ–¼ï¸', prices[type] || 0.99);
        }
        function buyEffect(type) {
            const prices = { gradient: 0.99, fire: 0.99, rainbow: 1.99 };
            showPurchaseModal('Effet ' + type.charAt(0).toUpperCase() + type.slice(1), 'âœ¨', prices[type] || 0.99);
        }
        function showPurchaseModal(name, icon, price) {
            const m = document.createElement('div');
            m.className = 'fixed inset-0 z-[999] flex items-center justify-center bg-black/70 backdrop-blur-sm';
            m.innerHTML = `<div class="bg-[#111] rounded-3xl border border-[#00bad6]/20 p-8 max-w-sm mx-4 text-center shadow-2xl">
                <div class="text-5xl mb-4">${icon}</div>
                <h3 class="text-xl font-black mb-2">${name}</h3>
                <p class="text-2xl font-black text-[#00bad6] mb-2">${price.toFixed(2)}â‚¬</p>
                <p class="text-sm text-slate-400 mb-4">Connecte-toi pour acheter cet article via Stripe.</p>
                <button type="button" onclick="this.closest('.fixed').remove()" class="w-full py-3 rounded-2xl bg-[#00bad6] font-black text-sm text-[#000] active:scale-95 transition-transform">Compris !</button>
            </div>`;
            document.body.appendChild(m);
            m.addEventListener('click', e => { if (e.target === m) m.remove(); });
        }

        function showSearch() { window.location.href = 'search.html'; }

        // Init
        renderFeed();
        try { API.auth.me().then(me => { if (me?.name) { document.getElementById('compAvatar').textContent = me.name[0].toUpperCase(); } }).catch(() => { }); } catch (e) { }

        // â”€â”€ Highlight post from URL hash (e.g. community.html#post-3) â”€â”€
        function highlightPost() {
            const hash = window.location.hash; // #post-3
            if (!hash || !hash.startsWith('#post-')) return;
            const postId = parseInt(hash.replace('#post-', ''));
            if (!postId) return;
            const el = document.getElementById('post-' + postId);
            if (!el) return;
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            // Add highlight animation
            setTimeout(() => {
                el.classList.add('post-highlight');
                setTimeout(() => el.classList.remove('post-highlight'), 3000);
            }, 400);
        }
        // Run after a short delay to allow renderFeed() to complete
        setTimeout(highlightPost, 300);

        // Follow notification handler from SW
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.addEventListener('message', e => {
                if (e.data?.type === 'FOLLOW_NOTIF') {
                    // Could show an in-app toast here
                }
            });
        }


        // Handle new post modal
        function openNewPostModal() {
            document.getElementById('newPostModal').classList.replace('hidden', 'flex');
            document.getElementById('postContent').focus();
        }
        function closeNewPostModal() {
            document.getElementById('newPostModal').classList.replace('flex', 'hidden');
            document.getElementById('postContent').value = '';
        }
        function submitNewPost() {
            const content = document.getElementById('postContent').value.trim();
            if (!content) return;
            const btn = document.getElementById('submitPostBtn');
            btn.innerHTML = '<span class="material-symbols-outlined animate-spin">sync</span> Publication...';
            // Simulate API call
            setTimeout(() => {
                closeNewPostModal();
                btn.innerHTML = '<span class="material-symbols-outlined">send</span> Publier';
                showToast('Ton message a Ã©tÃ© publiÃ© ! ğŸ‰', 'success');
            }, 800);
        }
    </script>

    <!-- FAB Ajouter Post -->
    <div class="fixed bottom-24 right-6 z-40">
        <button type="button" onclick="openNewPostModal()"
            class="w-14 h-14 bg-[#00bad6] text-[#000] rounded-full flex items-center justify-center shadow-lg shadow-[#00bad6]/30 hover:scale-105 active:scale-95 transition-transform">
            <span class="material-symbols-outlined text-[28px]">add</span>
        </button>
    </div>

    <!-- Modale Nouveau Post -->
    <div id="newPostModal"
        class="hidden fixed inset-0 z-50 items-center justify-center bg-black/60 backdrop-blur-sm p-4">
        <div class="w-full max-w-md bg-[#111] rounded-3xl border border-[#00bad6]/20 p-5 shadow-2xl relative">
            <button type="button" onclick="closeNewPostModal()"
                class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
            <h2 class="text-xl font-bold mb-4">Nouveau message</h2>
            <textarea id="postContent"
                class="w-full h-32 bg-black/20 border border-white/10 rounded-xl p-4 text-sm text-white focus:outline-none focus:border-[#00bad6]/40 resize-none mb-4"
                placeholder="Partage tes infos sur le spot, une question, une observation..."></textarea>

            <div class="flex items-center justify-between">
                <div class="flex gap-2">
                    <button type="button"
                        class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center text-[#00bad6] hover:bg-white/10 transition-colors">
                        <span class="material-symbols-outlined">add_photo_alternate</span>
                    </button>
                    <button type="button"
                        class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center text-emerald-400 hover:bg-white/10 transition-colors">
                        <span class="material-symbols-outlined">location_on</span>
                    </button>
                </div>
                <button type="button" id="submitPostBtn" onclick="submitNewPost()"
                    class="px-6 py-2.5 bg-[#00bad6] text-[#000] font-bold rounded-xl flex items-center gap-2 hover:opacity-90 transition-opacity active:scale-95 transition-transform">
                    <span class="material-symbols-outlined text-sm">send</span> Publier
                </button>
            </div>
        </div>
    </div>
    <!-- Image Lightbox -->
    <div id="imageLightbox"
        class="hidden fixed inset-0 z-[500] items-center justify-center bg-black/92 backdrop-blur-md"
        onclick="if(event.target===this)closeLightbox()">
        <button type="button" onclick="closeLightbox()"
            class="absolute top-4 right-4 w-10 h-10 rounded-full bg-white/10 flex items-center justify-center">
            <span class="material-symbols-outlined text-white">close</span>
        </button>
        <img loading="lazy" id="lightboxImg" src="" alt="Photo"
            class="max-w-full max-h-[90vh] object-contain rounded-xl shadow-2xl" />
    </div>

    <script>
        function openLightbox(src) {
            document.getElementById('lightboxImg').src = src;
            var lb = document.getElementById('imageLightbox');
            lb.classList.remove('hidden'); lb.classList.add('flex');
            document.body.style.overflow = 'hidden';
        }
        function closeLightbox() {
            var lb = document.getElementById('imageLightbox');
            lb.classList.add('hidden'); lb.classList.remove('flex');
            document.body.style.overflow = '';
        }
    </script>
    <script src="js/adsense.js"></script>
    <script src="js/share-social.js"></script>
    <script src="js/ui-components.js"></script>
    <script src="js/notif-badge.js"></script>
    <script src="js/stories.js"></script>
    <script src="/js/i18n.js"></script>
    <script src="/js/push_notifs.js" defer></script>
    <script src="/js/cookie-consent.js"></script>
    <script src="/js/monitoring.js"></script>
    <!-- Footer lÃ©gal requis RGPD -->
    <div style="text-align:center;padding:8px 16px 100px;font-size:10px;color:#334155">
        <a href="/legal.html" style="color:#334155;text-decoration:none;margin:0 6px">Mentions lÃ©gales</a>Â·
        <a href="/privacy.html" style="color:#334155;text-decoration:none;margin:0 6px">ConfidentialitÃ©</a>Â·
        <a href="/cgv.html" style="color:#334155;text-decoration:none;margin:0 6px">CGU</a>Â·
        <a href="/cookies.html" style="color:#334155;text-decoration:none;margin:0 6px">Cookies</a>
    </div>
    <script src="/pages/js/auth-state.js"></script>
    <script src="/js/offline-banner.js"></script>
  <script src="/js/error-handler.js" defer></script>

<script>
// Auto aria-current="page" sur nav
(function() {
  const path = window.location.pathname.split('/').pop();
  document.querySelectorAll('nav a, .bottom-nav a, .navbar a').forEach(link => {
    const href = link.getAttribute('href') || '';
    if (href === path || href.endsWith('/' + path)) {
      link.setAttribute('aria-current', 'page');
    }
  });
})();
</script>

<script>
// IntersectionObserver pour l'infinite scroll
(function() {
  const endMarker = document.createElement('div');
  endMarker.id = 'end-of-feed';
  endMarker.style.cssText = 'height:1px;margin:16px 0';
  endMarker.setAttribute('aria-hidden', 'true');
  
  const endMsg = document.createElement('div');
  endMsg.id = 'feed-end-message';
  endMsg.style.cssText = 'text-align:center;color:rgba(255,255,255,.3);padding:24px;font-size:13px;display:none';
  endMsg.textContent = 'ğŸŒŠ Tu as tout vu pour aujourd\'hui !';
  
  // Fonction appelÃ©e quand tout est chargÃ©
  window.showFeedEnd = function() {
    document.getElementById('feed-end-message').style.display = 'block';
  };
})();
</script>

<!-- Ad: Banner Bottom -->
<div class="ad-container" aria-label="PublicitÃ©" style="text-align:center;padding:8px 16px;min-height:60px;margin:12px 0;">
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-4490968258367543"
       data-ad-slot="8907854129"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>

<script>
// Injection de pub dans le feed community (toutes les 5 posts)
(function() {
  const AD_SLOT = "4822433178";
  const PUB_ID = "ca-pub-4490968258367543";
  let postCount = 0;
  
  // Observer les nouveaux posts ajoutÃ©s au feed
  const feedContainer = document.getElementById('community-feed') || 
                        document.querySelector('.feed-container, .posts-list, [data-feed]');
  
  if (!feedContainer) return;
  
  const observer = new MutationObserver((mutations) => {
    mutations.forEach(m => {
      m.addedNodes.forEach(node => {
        if (node.nodeType !== 1) return;
        if (node.classList?.contains('post-card') || node.classList?.contains('feed-item')) {
          postCount++;
          if (postCount % 5 === 0) {
            const adEl = document.createElement('div');
            adEl.className = 'ad-container';
            adEl.style.cssText = 'text-align:center;padding:8px 16px;margin:8px 0;border-radius:12px;background:rgba(255,255,255,.03)';
            adEl.setAttribute('aria-label', 'PublicitÃ©');
            adEl.innerHTML = `<ins class="adsbygoogle" style="display:block" data-ad-client="${PUB_ID}" data-ad-slot="${AD_SLOT}" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true"></ins>`;
            node.after(adEl);
            try { (adsbygoogle = window.adsbygoogle || []).push({}); } catch(e) {}
          }
        }
      });
    });
  });
  
  observer.addObserver ? observer.addObserver(feedContainer, {childList:true}) :
  observer.observe(feedContainer, {childList: true});
})();
</script>

<!-- Modal de signalement de post -->
<div id="report-modal" role="dialog" aria-modal="true" aria-labelledby="report-title"
  style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:2000;align-items:flex-end;justify-content:center;padding:0">
  <div style="background:#0f172a;border:1px solid rgba(255,255,255,.1);border-radius:20px 20px 0 0;padding:24px;width:100%;max-width:500px">
    <h2 id="report-title" style="font-size:18px;color:#f1f5f9;margin:0 0 20px">Signaler ce post</h2>
    <div id="report-options" style="display:flex;flex-direction:column;gap:8px">
      <button type="button" data-reason="spam" class="report-option-btn" style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 16px;color:#f1f5f9;text-align:left;cursor:pointer;font-size:15px">ğŸš« Spam ou pub non sollicitÃ©e</button>
      <button type="button" data-reason="inappropriate" class="report-option-btn" style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 16px;color:#f1f5f9;text-align:left;cursor:pointer;font-size:15px">âš ï¸ Contenu inappropriÃ©</button>
      <button type="button" data-reason="harassment" class="report-option-btn" style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 16px;color:#f1f5f9;text-align:left;cursor:pointer;font-size:15px">ğŸ˜¤ HarcÃ¨lement ou bullying</button>
      <button type="button" data-reason="false_info" class="report-option-btn" style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 16px;color:#f1f5f9;text-align:left;cursor:pointer;font-size:15px">âŒ Fausses informations</button>
      <button type="button" data-reason="other" class="report-option-btn" style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 16px;color:#f1f5f9;text-align:left;cursor:pointer;font-size:15px">ğŸ“Œ Autre raison</button>
    </div>
    <button type="button" onclick="closeReportModal()" style="width:100%;margin-top:12px;padding:14px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;color:#94a3b8;cursor:pointer;font-size:15px">Annuler</button>
  </div>
</div>

<script>
let _reportPostId = null;

function openReportModal(postId) {
  _reportPostId = postId;
  const modal = document.getElementById('report-modal');
  if (modal) modal.style.display = 'flex';
}

function closeReportModal() {
  const modal = document.getElementById('report-modal');
  if (modal) modal.style.display = 'none';
  _reportPostId = null;
}

async function submitReport(reason) {
  closeReportModal();
  try {
    const user = (await supabase.auth.getUser()).data.user;
    if (!user) return;
    await supabase.from('post_reports').insert({
      post_id: _reportPostId,
      reporter_id: user.id,
      reason: reason,
      created_at: new Date().toISOString()
    });
    if (typeof showToast === 'function') showToast('âœ… Signalement envoyÃ© â€” Merci !', 'success');
  } catch(e) {
    if (e?.code === '42P01') {
      // Table n'existe pas encore â€” ignorer silencieusement
      if (typeof showToast === 'function') showToast('âœ… Signalement pris en compte', 'success');
    }
  }
}

document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.report-option-btn').forEach(btn => {
    btn.addEventListener('click', () => submitReport(btn.dataset.reason));
  });
  document.getElementById('report-modal')?.addEventListener('click', function(e) {
    if (e.target === this) closeReportModal();
  });
});

window.openReportModal = openReportModal;
window.closeReportModal = closeReportModal;
</script>
</body>

</html>